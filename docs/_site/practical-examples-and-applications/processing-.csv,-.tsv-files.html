<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Processing .CSV, .TSV Files | Musoq</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Processing .CSV, .TSV Files" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="SQL Swiss Army Knife - Engine for Diverse Data Sources" /> <meta property="og:description" content="SQL Swiss Army Knife - Engine for Diverse Data Sources" /> <link rel="canonical" href="http://localhost:4000/practical-examples-and-applications/processing-.csv,-.tsv-files.html" /> <meta property="og:url" content="http://localhost:4000/practical-examples-and-applications/processing-.csv,-.tsv-files.html" /> <meta property="og:site_name" content="Musoq" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Processing .CSV, .TSV Files" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"SQL Swiss Army Knife - Engine for Diverse Data Sources","headline":"Processing .CSV, .TSV Files","url":"http://localhost:4000/practical-examples-and-applications/processing-.csv,-.tsv-files.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Musoq </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in SQL Syntax of the Tool category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sql-syntax-of-the-tool.html" class="nav-list-link">SQL Syntax of the Tool</a><ul class="nav-list"><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/introduction.html" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/basic-syntax-elements.html" class="nav-list-link">Basic Syntax Elements</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/from-clause.html" class="nav-list-link">FROM Clause</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/where-clause.html" class="nav-list-link">WHERE Clause</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/group-by-clause.html" class="nav-list-link">GROUP BY Clause</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/select-clause.html" class="nav-list-link">SELECT Clause</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/join-clause.html" class="nav-list-link">JOIN Clause</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/set-operators.html" class="nav-list-link">Set Operators</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/common-table-expressions-(cte).html" class="nav-list-link">Common Table Expressions (CTE)</a></li><li class="nav-list-item"><a href="/sql-syntax-of-the-tool/specific-syntactic-constructions.html" class="nav-list-link">Specific Syntactic Constructions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Practical Examples and Applications category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/practical-examples-and-applications.html" class="nav-list-link">Practical Examples and Applications</a><ul class="nav-list"><li class="nav-list-item"><a href="/practical-examples-and-applications/introduction.html" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="/practical-examples-and-applications/operating-system-as-a-data-source.html" class="nav-list-link">Operating System as a Data Source</a></li><li class="nav-list-item"><a href="/practical-examples-and-applications/processing-.csv,-.tsv-files.html" class="nav-list-link">Processing .CSV, .TSV Files</a></li><li class="nav-list-item"><a href="/practical-examples-and-applications/time-utilization.html" class="nav-list-link">Time Utilization</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Utilities category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/utilities.html" class="nav-list-link">Utilities</a><ul class="nav-list"><li class="nav-list-item"><a href="/utilities/json-path-extraction.html" class="nav-list-link">JSON Path Extraction</a></li></ul></li><li class="nav-list-item"><a href="/cli.html" class="nav-list-link">Setup & Usage</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Data Sources category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources.html" class="nav-list-link">Data Sources</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Airtable category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Airtable/architectures.html" class="nav-list-link">Airtable</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Airtable/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Airtable/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Airtable/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Airtable/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Archives category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Archives/architectures.html" class="nav-list-link">Archives</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Archives/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Archives/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Archives/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Archives/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in CANBus category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/CANBus/architectures.html" class="nav-list-link">CANBus</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/CANBus/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/CANBus/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/CANBus/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/CANBus/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Docker category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Docker/architectures.html" class="nav-list-link">Docker</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Docker/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Docker/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Docker/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Docker/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in FlatFile category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/FlatFile/architectures.html" class="nav-list-link">FlatFile</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/FlatFile/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/FlatFile/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/FlatFile/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/FlatFile/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Json category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Json/architectures.html" class="nav-list-link">Json</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Json/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Json/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Json/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Json/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Kubernetes category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Kubernetes/architectures.html" class="nav-list-link">Kubernetes</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Kubernetes/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Kubernetes/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Kubernetes/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Kubernetes/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Ollama category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Ollama/architectures.html" class="nav-list-link">Ollama</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Ollama/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Ollama/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Ollama/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Ollama/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in OpenAI category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/OpenAI/architectures.html" class="nav-list-link">OpenAI</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/OpenAI/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/OpenAI/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/OpenAI/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/OpenAI/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Os category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Os/architectures.html" class="nav-list-link">Os</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Os/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Os/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Os/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Os/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Postgres category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Postgres/architectures.html" class="nav-list-link">Postgres</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Postgres/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Postgres/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Postgres/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Postgres/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Roslyn category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/roslyn/architectures.html" class="nav-list-link">Roslyn</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/roslyn/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/roslyn/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/roslyn/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/roslyn/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in SeparatedValues category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/SeparatedValues/architectures.html" class="nav-list-link">SeparatedValues</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/SeparatedValues/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/SeparatedValues/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/SeparatedValues/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/SeparatedValues/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Sqlite category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Sqlite/architectures.html" class="nav-list-link">Sqlite</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Sqlite/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Sqlite/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Sqlite/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Sqlite/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in System category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/System/architectures.html" class="nav-list-link">System</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/System/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/System/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/System/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/System/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Time category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/data-sources/Time/architectures.html" class="nav-list-link">Time</a><ul class="nav-list"><li class="nav-list-item"><a href="/data-sources/Time/linux-arm64.html" class="nav-list-link">Linux Arm64</a></li><li class="nav-list-item"><a href="/data-sources/Time/linux-x64.html" class="nav-list-link">Linux X64</a></li><li class="nav-list-item"><a href="/data-sources/Time/macos-x64.html" class="nav-list-link">MacOs X64</a></li><li class="nav-list-item"><a href="/data-sources/Time/windows-x64.html" class="nav-list-link">Windows X64</a></li></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Musoq" aria-label="Search Musoq" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/Puchaczov/Musoq" class="site-button" > Musoq on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/practical-examples-and-applications.html">Practical Examples and Applications</a></li> <li class="breadcrumb-nav-list-item"><span>Processing .CSV, .TSV Files</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="processing-structured-files"> <a href="#processing-structured-files" class="anchor-heading" aria-labelledby="processing-structured-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Processing Structured Files </h1> <p><code class="language-plaintext highlighter-rouge">.csv</code>, <code class="language-plaintext highlighter-rouge">.tsv</code> are simple text files in which columns are separated by special separators (e.g., comma or tab), and the end of a row is marked by an end-of-line character. Such files may, but don’t have to, have a header describing what each column is. The header is always the first row in the file. Below is a sample table generated that we will use to perform transformations and calculations for our queries.</p> <p>| Category | Product | Quantity | UnitPrice | | —- | —- | —- | —- | | Home Appliances | Vacuum Cleaner | 82 | 163.77 | | Books | Science | 5 | 47.56 | | Computer Accessories | Webcam | 1 | 113.5 | | Fashion | T-shirt | 74 | 181.97 | | Fashion | Jeans | 8 | 159.87 | | Fashion | Hat | 53 | 136.61 | | Home Appliances | Refrigerator | 22 | 130.62 | | Computer Accessories | Speaker | 98 | 103.57 | | Home Appliances | Refrigerator | 17 | 121.75 | | Books | Biography | 23 | 10.07 | | Computer Accessories | Speaker | 6 | 109.77 | | Fashion | Jeans | 21 | 195.95 | | Fashion | Sneakers | 69 | 34.7 | | Electronics | Smartwatch | 86 | 151.0 | | Electronics | Laptop | 7 | 189.76 | | Electronics | Tablet | 20 | 115.77 | | Computer Accessories | Mouse | 44 | 178.51 | | Home Appliances | Blender | 62 | 85.69 | | Home Appliances | Vacuum Cleaner | 48 | 14.64 | | Electronics | Headphones | 49 | 185.01 | | Electronics | Laptop | 15 | 101.91 | | Fashion | Jeans | 90 | 67.94 | | Computer Accessories | Keyboard | 74 | 12.86 | | Fashion | Hat | 34 | 120.21 | | Books | History | 1 | 98.95 | | Computer Accessories | Speaker | 32 | 135.16 | | Electronics | Tablet | 32 | 86.54 | | Electronics | Laptop | 42 | 54.91 | | Electronics | Headphones | 12 | 192.94 | | Electronics | Smartwatch | 40 | 83.4 | | Home Appliances | Blender | 65 | 50.17 | | Fashion | Hat | 28 | 82.16 | | Home Appliances | Washing Machine | 50 | 77.21 | | Electronics | Smartphone | 47 | 185.91 | | Books | Biography | 42 | 24.57 | | Fashion | Jeans | 13 | 73.85 | | Computer Accessories | Speaker | 34 | 69.99 | | Electronics | Laptop | 66 | 198.1 | | Books | Science | 18 | 188.15 | | Fashion | Sneakers | 60 | 131.19 | | Books | Mystery | 81 | 73.11 | | Fashion | Jeans | 51 | 30.24 | | Home Appliances | Refrigerator | 14 | 161.9 | | Computer Accessories | Keyboard | 50 | 121.49 | | Fashion | Jacket | 54 | 146.29 | | Computer Accessories | Webcam | 12 | 133.3 | | Computer Accessories | Monitor | 30 | 5.32 | | Home Appliances | Blender | 43 | 157.01 | | Books | Mystery | 59 | 58.53 | | Computer Accessories | Speaker | 8 | 156.03 | | Computer Accessories | Mouse | 17 | 132.75 | | Fashion | Jeans | 33 | 43.96 | | Electronics | Laptop | 43 | 132.83 | | Computer Accessories | Webcam | 96 | 68.64 | | Electronics | Laptop | 30 | 125.86 | | Fashion | T-shirt | 67 | 198.49 | | Books | Science | 9 | 135.57 | | Books | Science | 31 | 8.89 | | Fashion | T-shirt | 89 | 197.07 | | Electronics | Smartwatch | 17 | 107.64 | | Computer Accessories | Monitor | 9 | 171.51 | | Fashion | Sneakers | 79 | 168.12 | | Fashion | T-shirt | 65 | 78.55 | | Fashion | Hat | 22 | 73.59 | | Computer Accessories | Webcam | 31 | 164.67 | | Fashion | Jeans | 83 | 20.63 | | Books | History | 50 | 186.23 | | Electronics | Camera | 18 | 183.47 | | Computer Accessories | Speaker | 44 | 136.75 | | Books | Novel | 23 | 183.86 | | Home Appliances | Refrigerator | 26 | 155.14 | | Books | Science | 87 | 120.53 | | Electronics | Smartphone | 26 | 91.9 | | Computer Accessories | Speaker | 12 | 27.0 | | Fashion | Hat | 48 | 112.67 | | Fashion | Hat | 78 | 23.1 | | Books | History | 10 | 91.04 | | Electronics | Laptop | 78 | 168.49 | | Books | Mystery | 58 | 65.09 | | Home Appliances | Microwave | 78 | 115.89 | | Books | Biography | 1 | 155.56 | | Books | History | 18 | 174.27 | | Computer Accessories | Mouse | 23 | 130.46 | | Home Appliances | Blender | 19 | 70.96 | | Books | Novel | 92 | 118.97 | | Home Appliances | Washing Machine | 17 | 147.19 | | Books | History | 32 | 194.87 | | Home Appliances | Vacuum Cleaner | 42 | 140.49 | | Fashion | Jacket | 34 | 134.91 | | Electronics | Smartphone | 82 | 167.1 | | Home Appliances | Vacuum Cleaner | 96 | 191.72 | | Fashion | Hat | 78 | 58.36 | | Books | Mystery | 27 | 96.87 | | Electronics | Camera | 5 | 158.05 | | Books | Novel | 74 | 170.65 | | Fashion | Jacket | 13 | 199.69 | | Computer Accessories | Mouse | 66 | 93.49 | | Home Appliances | Vacuum Cleaner | 88 | 155.43 | | Home Appliances | Microwave | 10 | 71.59 | | Computer Accessories | Mouse | 3 | 26.24 |</p> <h2 id="enriching-the-table-with-calculations"> <a href="#enriching-the-table-with-calculations" class="anchor-heading" aria-labelledby="enriching-the-table-with-calculations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enriching the Table with Calculations </h2> <p>First, we will enrich our calculations by determining the total price <code class="language-plaintext highlighter-rouge">UnitPrice</code> * <code class="language-plaintext highlighter-rouge">Quantity</code>.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> 
	<span class="o">*</span><span class="p">,</span> 
	<span class="n">ToInt32</span><span class="p">(</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">*</span> <span class="n">ToDecimal</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">)</span> <span class="k">as</span> <span class="n">TotalPrice</span> 
<span class="k">from</span> <span class="o">#</span><span class="n">separatedvalues</span><span class="p">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">'@qfs/category_product_data.csv'</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <p>We begin by reading the file from the query space named <code class="language-plaintext highlighter-rouge">category_product_data.csv</code> which has a header <code class="language-plaintext highlighter-rouge">true</code> and we are supposed to start reading from row zero <code class="language-plaintext highlighter-rouge">0</code>. Because our data source reads all columns as string types, we have to convert them to numbers. With each row read, a transformation will be performed on the relevant columns followed by multiplication.</p> <p>Table after our transformations:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Category</th> <th>Product</th> <th>Quantity</th> <th>UnitPrice</th> <th>TotalPrice</th> </tr> </thead> <tbody> <tr> <td>Home Appliances</td> <td>Vacuum Cleaner</td> <td>82</td> <td>163.77</td> <td>13429.14</td> </tr> <tr> <td>Books</td> <td>Science</td> <td>5</td> <td>47.56</td> <td>237.8</td> </tr> <tr> <td>Computer Accessories</td> <td>Webcam</td> <td>1</td> <td>113.5</td> <td>113.5</td> </tr> <tr> <td>….</td> <td>…</td> <td>…</td> <td>…</td> <td>…</td> </tr> <tr> <td>Computer Accessories</td> <td>Mouse</td> <td>3</td> <td>26.24</td> <td>78.72</td> </tr> </tbody> </table></div> <h2 id="when-the-file-has-no-header"> <a href="#when-the-file-has-no-header" class="anchor-heading" aria-labelledby="when-the-file-has-no-header"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> When the File Has No Header </h2> <p>If our file doesn’t have a header or the names are very irregular, we can simply skip the header row, indicating that the file doesn’t have a header. This will result in automatically assigned column names <code class="language-plaintext highlighter-rouge">Column1</code>, <code class="language-plaintext highlighter-rouge">Column2</code>, … <code class="language-plaintext highlighter-rouge">ColumnN</code>.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> 
	<span class="o">*</span><span class="p">,</span> 
	<span class="n">ToInt32</span><span class="p">(</span><span class="n">Column3</span><span class="p">)</span> <span class="o">*</span> <span class="n">ToDecimal</span><span class="p">(</span><span class="n">Column4</span><span class="p">)</span> <span class="k">as</span> <span class="n">Column5</span> 
<span class="k">from</span> <span class="o">#</span><span class="n">separatedvalues</span><span class="p">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">'@qfs/category_product_data.csv'</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p>Table after our transformations:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Column1</th> <th>Column2</th> <th>Column3</th> <th>Column4</th> <th>Column5</th> </tr> </thead> <tbody> <tr> <td>Home Appliances</td> <td>Vacuum Cleaner</td> <td>82</td> <td>163.77</td> <td>13429.14</td> </tr> <tr> <td>Books</td> <td>Science</td> <td>5</td> <td>47.56</td> <td>237.8</td> </tr> <tr> <td>Computer Accessories</td> <td>Webcam</td> <td>1</td> <td>113.5</td> <td>113.5</td> </tr> <tr> <td>….</td> <td>…</td> <td>…</td> <td>…</td> <td>…</td> </tr> <tr> <td>Computer Accessories</td> <td>Mouse</td> <td>3</td> <td>26.24</td> <td>78.72</td> </tr> </tbody> </table></div> <h2 id="lets-now-calculate-the-total-price-for-products-in-a-given-category-and-the-total-price-for-a-product-in-a-given-category"> <a href="#lets-now-calculate-the-total-price-for-products-in-a-given-category-and-the-total-price-for-a-product-in-a-given-category" class="anchor-heading" aria-labelledby="lets-now-calculate-the-total-price-for-products-in-a-given-category-and-the-total-price-for-a-product-in-a-given-category"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Let’s Now Calculate the Total Price for Products in a Given Category and the Total Price for a Product in a Given Category </h2> <p>To get the desired effect in one query, we will use grouping, aggregate methods in the parent group (<code class="language-plaintext highlighter-rouge">TotalPriceForCategory</code>), and the current group’s aggregate method (<code class="language-plaintext highlighter-rouge">TotalPriceForProduct</code>).</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> 
    <span class="n">Category</span><span class="p">,</span> 
    <span class="n">Product</span><span class="p">,</span> 
    <span class="k">Sum</span><span class="p">(</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">*</span> <span class="n">ToDecimal</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">TotalPriceForCategory</span><span class="p">,</span> 
    <span class="k">Sum</span><span class="p">(</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">*</span> <span class="n">ToDecimal</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">))</span> <span class="k">as</span> <span class="n">TotalPriceForProduct</span> 
<span class="k">from</span> <span class="o">#</span><span class="n">separatedvalues</span><span class="p">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">'@qfs/category_product_data.csv'</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> 
<span class="k">group</span> <span class="k">by</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Product</span>
</code></pre></div></div> <p>This query works by creating subgroups of categories, then creating further subgroups of products within each of these. The expression <code class="language-plaintext highlighter-rouge">Sum(ToInt32(Quantity) * ToDecimal(UnitPrice))</code> accesses the innermost subgroup (products), while <code class="language-plaintext highlighter-rouge">Sum(ToInt32(Quantity) * ToDecimal(UnitPrice), 1)</code> accesses the parent subgroup, the subgroup of the given category, and performs its calculations there. The results of this query are the aggregated calculations:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Category</th> <th>Product</th> <th>TotalPriceForCategory</th> <th>TotalPriceForProduct</th> </tr> </thead> <tbody> <tr> <td>Home Appliances</td> <td>Vacuum Cleaner</td> <td>96150.58</td> <td>52115.4</td> </tr> <tr> <td>Books</td> <td>Science</td> <td>80287</td> <td>15606.33</td> </tr> <tr> <td>…</td> <td>…</td> <td>…</td> <td>…</td> </tr> </tbody> </table></div> <p>These calculations can be verified using an auxiliary Python script:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">TotalPrice</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Quantity</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">UnitPrice</span><span class="sh">'</span><span class="p">]</span>

<span class="n">total_price_per_category</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">Category</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">TotalPrice</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="n">total_price_per_product_in_category</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">Category</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Product</span><span class="sh">'</span><span class="p">])[</span><span class="sh">'</span><span class="s">TotalPrice</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="n">total_price_per_category</span><span class="p">,</span> <span class="n">total_price_per_product_in_category</span>
</code></pre></div></div> <h2 id="sentiment-analysis-of-posts-using-gpt"> <a href="#sentiment-analysis-of-posts-using-gpt" class="anchor-heading" aria-labelledby="sentiment-analysis-of-posts-using-gpt"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sentiment Analysis of Posts Using GPT </h2> <p>Suppose we received the following data:</p> <div class="table-wrapper"><table> <thead> <tr> <th>PostId</th> <th>Comment</th> <th>Date</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>This product is amazing! Highly recommend.</td> <td>2023-01-01</td> </tr> <tr> <td>2</td> <td>Absolutely terrible service, I’m very disappointed.</td> <td>2023-01-02</td> </tr> <tr> <td>3</td> <td>The product is okay, nothing special.</td> <td>2023-01-03</td> </tr> <tr> <td>…</td> <td>…</td> <td>…</td> </tr> <tr> <td>6</td> <td>It’s a decent product, but I had higher expectations.</td> <td>2023-01-06</td> </tr> </tbody> </table></div> <p>We need to determine the sentiment with which the posts were written, and to this end, we can use a data source such as the <code class="language-plaintext highlighter-rouge">GPT</code> model from <code class="language-plaintext highlighter-rouge">OpenAI</code>. The query in a simple way will return whether a given post has a positive, negative, or neutral sentiment.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> 
    <span class="n">csv</span><span class="p">.</span><span class="n">PostId</span><span class="p">,</span>
    <span class="n">csv</span><span class="p">.</span><span class="k">Comment</span><span class="p">,</span>
    <span class="n">gpt</span><span class="p">.</span><span class="n">Sentiment</span><span class="p">(</span><span class="n">csv</span><span class="p">.</span><span class="k">Comment</span><span class="p">)</span> <span class="k">as</span> <span class="n">Sentiment</span><span class="p">,</span>
    <span class="n">csv</span><span class="p">.</span><span class="nb">Date</span>
<span class="k">from</span> <span class="o">#</span><span class="n">separatedvalues</span><span class="p">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">'@qfs/comments_sample.csv'</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="n">csv</span> <span class="k">inner</span> <span class="k">join</span> <span class="o">#</span><span class="n">openai</span><span class="p">.</span><span class="n">gpt</span><span class="p">(</span><span class="s1">'gpt-4-1106-preview'</span><span class="p">)</span> <span class="n">gpt</span> <span class="k">on</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div> <p>In this query, we use an <code class="language-plaintext highlighter-rouge">inner join</code> because we want to use a method that belongs to the calculated <strong>gpt</strong> table. This table always returns a single row; we are not specifically interested in the row value but want it to be available for each message. When initializing, we use the exact model name which is supposed to respond to our sentiment query. The data source <code class="language-plaintext highlighter-rouge">#openai.gpt</code> has more interesting methods with which I encourage you to become familiar in the source documentation.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
